Setting Up VIPs

   You can set up VIPs using the MapR Control System or the CLI.

Adding VIPs Using the MapR Control System

   You can use the MCS to specify a range of virtual IP addresses and
   assign them to the pool of servers that are running the NFS service.
   You can also restrict the assignment of virtual IP addresses to certain
   subnets.

   Before following this procedure, make sure:
     * You have installed NFS on at least three nodes (recommended).
     * You have started the NFS gateway service on the servers to which
       you plan to assign VIPs.

    1. Log in to MCS and go to the [1]service information page for NFS.
    2. Click Add Virtual IP to display the Add Virtual IP page.
    3. Enter the start of the VIP range in the Starting Virtual IP field.
       MapR distributes the VIPs in this range to the selected network
       interfaces. VIPs are automatically migrated between the network
       interfaces when failures occur.
    4. Enter the end of the VIP range in the Ending Virtual IP field.
       If you are assigning only one VIP, you can leave the field blank.
       MapR distributes the VIPs in this range to the selected network
       interfaces. VIPs are automatically migrated between the network
       interfaces when failures occur.
    5. Enter the Netmask for the VIP range in the Netmask field.
       For example: 255.255.255.0MapR assigns this netmask to the network
       interfaces along with the VIPs.
    6. (Not available in v6.0.1) Specify whether (Yes) or not (No) to
       assign a particular VIP address to a specific server or MAC
       address. If Yes, enter the MAC address for the network interface to
       be assigned to the listed VIP address. The remaining VIP addresses
       from the same pool are assigned randomly.
    7. (Not available in v6.0.1) Select one of the following:
          + Use all network interfaces on all nodes that are running the
            NFS Gateway service to set up VIPs that use all network
            interfaces on all the nodes running the NFS Gateway service.
            If additional NFS Gateway services are started, the network
            interfaces on their nodes will automatically become candidates
            for the VIPs in this range.
          + Select network interfaces to restrict the assignment of
            virtual IP addresses to certain subnets:
            A list of available and selected node names, physical IP
            addresses, and MAC addresses displays. Select from the:
               o Available list and click [rightArrow.png] to move
                 selection to Selected VIPs.
               o Selected list and click [leftArrow.png] to remove from
                 selected list of VIPs.
            See [2]Designating NICs for MapR.
    8. Confirm the actual VIP assignment by clicking Save Changes.
       It might take up to 40 seconds to assign the VIPs. If necessary,
       refresh the page in your browser to view the list of VIPs.

Adding VIPs Using the CLI or REST API

   The basic command to set up VIPs is:
maprcli virtualip add -netmask <netmask> -virtualip <virtualip>

   For complete reference, see [3]virtualip add.

References

   1. file://localhost/root/docsync/tmp/maprdocs.mapr.com/home/ClusterAdministration/services/ViewInfo.html
   2. file://localhost/root/docsync/tmp/maprdocs.mapr.com/home/AdministratorGuide/DesignatingNICs.html
   3. file://localhost/root/docsync/tmp/maprdocs.mapr.com/home/ReferenceGuide/virtualip-add.html
